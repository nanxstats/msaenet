<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="msaenet">
<title>A Quick Introduction to msaenet • msaenet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Quick Introduction to msaenet">
<meta property="og:description" content="msaenet">
<meta property="og:image" content="https://nanx.me/msaenet/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msaenet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/msaenet.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nanxstats/msaenet/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A Quick Introduction to msaenet</h1>
                        <h4 data-toc-skip class="author">Nan Xiao &lt;<a href="https://nanx.me" class="external-link uri">https://nanx.me</a>&gt;</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nanxstats/msaenet/blob/HEAD/vignettes/msaenet.Rmd" class="external-link"><code>vignettes/msaenet.Rmd</code></a></small>
      <div class="d-none name"><code>msaenet.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>msaenet</code> package implemented the multi-step adaptive elastic-net method introduced in <span class="citation">Xiao and Xu (2015)</span> for feature selection in high-dimensional regressions.</p>
</div>
<div class="section level2">
<h2 id="walkthrough">Walkthrough<a class="anchor" aria-label="anchor" href="#walkthrough"></a>
</h2>
<p>Let’s load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://nanx.me/msaenet/">"msaenet"</a></span><span class="op">)</span></code></pre></div>
<p>First, we generate some simulated data under a setting often used for testing high-dimensional linear models, with the function <code><a href="../reference/msaenet.sim.gaussian.html">msaenet.sim.gaussian()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msaenet.sim.gaussian.html">msaenet.sim.gaussian</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">150</span>, p <span class="op">=</span> <span class="fl">500</span>, rho <span class="op">=</span> <span class="fl">0.5</span>,
  coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, snr <span class="op">=</span> <span class="fl">5</span>, p.train <span class="op">=</span> <span class="fl">0.7</span>,
  seed <span class="op">=</span> <span class="fl">1001</span>
<span class="op">)</span></code></pre></div>
<p>The parameter <code>rho</code> controls the degree of correlation among the variables. <code>coef</code> sets the coefficients of the “true” variables, and in this case, the first 10 variables will have coefficient 1 while the other 490 variables will have coefficient 0. <code>snr</code> represents the designated signal-to-noise ratio (SNR) in the simulated data. The parameter <code>p.train</code> decides the proportion of the training set (relative to the total number of observations <code>n</code>).</p>
<p>To generate simulation data for the other types of generalized linear models supported by <code>msaenet</code>, simply use <code><a href="../reference/msaenet.sim.binomial.html">msaenet.sim.binomial()</a></code> (logistic regression), <code><a href="../reference/msaenet.sim.cox.html">msaenet.sim.cox()</a></code> (Cox regression), or <code><a href="../reference/msaenet.sim.poisson.html">msaenet.sim.poisson()</a></code> (Poisson regression).</p>
<p>The returned object <code>dat</code> contains both the training and test set. We will only use the training set to do the modeling (parameter tuning and model fitting), and then evaluate the model’s performance on the test set independently.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msaenet.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msaenet.html">msaenet</a></span><span class="op">(</span>
  <span class="va">dat</span><span class="op">$</span><span class="va">x.tr</span>, <span class="va">dat</span><span class="op">$</span><span class="va">y.tr</span>,
  alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,
  nsteps <span class="op">=</span> <span class="fl">10L</span>, tune.nsteps <span class="op">=</span> <span class="st">"ebic"</span>,
  seed <span class="op">=</span> <span class="fl">1005</span>
<span class="op">)</span></code></pre></div>
<p>The parameter <code>alphas</code> sets the alpha tuning grid for elastic-net in all adaptive estimation steps. <code>nsteps</code> indicates how many adaptive estimation steps should be used.</p>
<p>By default, the internal parameter tuning is done by k-fold cross-validation, and the parameters which produce the minimum prediction errors will be selected. You could also set <code>parallel = TRUE</code> and run</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"doParallel"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>before calling this function to make the parameter tuning run in parallel. This will probably save some time if the <code>alphas</code> grid is denser and the data size is larger.</p>
<p>To select the optimal model in each estimation step with a different criterion, use the argument <code>tune</code>. Options include <code>"cv"</code> (k-fold cross-validation, default), <code>"aic"</code> (AIC), <code>"bic"</code> (BIC), and <code>"ebic"</code> (Extened BIC). Similarly, use <code>tune.nsteps</code> to specify the criterion for selecting the optimal estimation step (the optimal model from all steps), options include <code>"max"</code> (select the final-step, default), <code>"aic"</code>, <code>"bic"</code>, and <code>"ebic"</code>.</p>
<p>Let’s inspect the fitted model, by looking into the best step and the selected variables (variables with non-zero coefficients), and the number of false positive selections/true positive selections:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msaenet.fit</span><span class="op">$</span><span class="va">best.step</span>
<span class="co">#&gt; [1] 6</span>
<span class="fu"><a href="../reference/msaenet.nzv.html">msaenet.nzv</a></span><span class="op">(</span><span class="va">msaenet.fit</span><span class="op">)</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="fu"><a href="../reference/msaenet.nzv.all.html">msaenet.nzv.all</a></span><span class="op">(</span><span class="va">msaenet.fit</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;  [1]   1   2   3   4   5   6   7   8   9  10  22  33  35  47 124 183 191 225 266</span>
<span class="co">#&gt; [20] 269 312 325 334 363 379 388 396 449</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;  [1]   1   2   3   4   5   6   7   8   9  10  35 269 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;  [1]   2   3   4   5   6   7   8   9  10  35 269 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[7]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[8]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[9]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[10]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[11]]</span>
<span class="co">#&gt;  [1]   2   3   4   6   7   9  10  35 363 379</span>
<span class="fu"><a href="../reference/msaenet.fp.html">msaenet.fp</a></span><span class="op">(</span><span class="va">msaenet.fit</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; [1] 3</span>
<span class="fu"><a href="../reference/msaenet.tp.html">msaenet.tp</a></span><span class="op">(</span><span class="va">msaenet.fit</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; [1] 7</span></code></pre></div>
<p>Next, we make predictions on the test set using the fitted model, and compute some evaluation metrics, such as RMSE and MAE:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msaenet.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">msaenet.fit</span>, <span class="va">dat</span><span class="op">$</span><span class="va">x.te</span><span class="op">)</span>
<span class="fu"><a href="../reference/msaenet.rmse.html">msaenet.rmse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">y.te</span>, <span class="va">msaenet.pred</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.638096</span>
<span class="fu"><a href="../reference/msaenet.mae.html">msaenet.mae</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">y.te</span>, <span class="va">msaenet.pred</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.172675</span></code></pre></div>
<p>A coefficient plot that shows the coefficient changes of all the variables across every adaptive estimation step:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msaenet.fit</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="msaenet_files/figure-html/unnamed-chunk-8-1.png" width="750" height="600"></p>
<p>The y-axis in the plot represents the relative effect size estimations (standardized into [0, 1]) of the variables.</p>
<p>Plot the change of the information criterion (EBIC here) used to select the optimal step:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msaenet.fit</span>, type <span class="op">=</span> <span class="st">"criterion"</span><span class="op">)</span></code></pre></div>
<p><img src="msaenet_files/figure-html/unnamed-chunk-9-1.png" width="750" height="450"></p>
<p>Create a Cleveland dot plot for the model coefficients at the optimal step:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msaenet.fit</span>, type <span class="op">=</span> <span class="st">"dotplot"</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, label.cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="msaenet_files/figure-html/unnamed-chunk-10-1.png" width="750" height="600"></p>
<p>To plot the absolute values of the coefficients instead of the raw coefficients, use <code>abs = TRUE</code>.</p>
<p>The vanilla adaptive elastic-net <span class="citation">(Zou and Zhang 2009)</span> is implemented by the function <code><a href="../reference/aenet.html">aenet()</a></code>. For multi-step adaptive estimation based on MCP-net or SCAD-net, see <code><a href="../reference/amnet.html">?amnet</a></code>, <code><a href="../reference/asnet.html">?asnet</a></code>, <code><a href="../reference/msamnet.html">?msamnet</a></code>, and <code><a href="../reference/msasnet.html">?msasnet</a></code> for details. All the analyses above apply to the models fitted by these functions as well.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>If you used <code>msaenet</code> in your research, please feel free to cite our paper <span class="citation">(Xiao and Xu 2015)</span> in your publications. If you have any questions or have a bug to report, please <a href="mailto:me@nanx.me">email me</a> or <a href="https://github.com/nanxstats/msaenet/issues" class="external-link">create an issue</a> on GitHub.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-xiao2015msaenet" class="csl-entry">
Xiao, Nan, and Qing-Song Xu. 2015. <span>“Multi-Step Adaptive Elastic-Net: Reducing False Positives in High-Dimensional Variable Selection.”</span> <em>Journal of Statistical Computation and Simulation</em> 85 (18): 3755–65.
</div>
<div id="ref-zou2009aenet" class="csl-entry">
Zou, Hui, and Hao Helen Zhang. 2009. <span>“On the Adaptive Elastic-Net with a Diverging Number of Parameters.”</span> <em>The Annals of Statistics</em> 37 (4): 1733–51.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nan Xiao, Qing-Song Xu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
