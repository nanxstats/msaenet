<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Quick Introduction to msaenet • msaenet</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="A Quick Introduction to msaenet">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-84529029-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84529029-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msaenet</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/msaenet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/road2stat/msaenet">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A Quick Introduction to msaenet</h1>
                        <h4 class="author">Nan Xiao &lt;<a href="https://nanx.me" class="uri">https://nanx.me</a>&gt;</h4>
            
            <h4 class="date">2018-04-19</h4>
      
      <small>Source: <a href="https://github.com/road2stat/msaenet/blob/master/vignettes/msaenet.Rmd"><code>vignettes/msaenet.Rmd</code></a></small>
      <div class="hidden name"><code>msaenet.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>msaenet</code> package implemented the multi-step adaptive elastic-net method introduced in <span class="citation">Xiao and Xu (2015)</span> for feature selection in high-dimensional regressions.</p>
</div>
<div id="walkthrough" class="section level1">
<h1 class="hasAnchor">
<a href="#walkthrough" class="anchor"></a>Walkthrough</h1>
<p>Let’s load the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(<span class="st">"msaenet"</span>)</a></code></pre></div>
<p>First, we generate some simulated data under a setting often used for testing high-dimensional linear models, with the function <code><a href="../reference/msaenet.sim.gaussian.html">msaenet.sim.gaussian()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">dat =<span class="st"> </span><span class="kw"><a href="../reference/msaenet.sim.gaussian.html">msaenet.sim.gaussian</a></span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="dt">n =</span> <span class="dv">150</span>, <span class="dt">p =</span> <span class="dv">500</span>, <span class="dt">rho =</span> <span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">coef =</span> <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">snr =</span> <span class="dv">3</span>, <span class="dt">p.train =</span> <span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">seed =</span> <span class="dv">1001</span>)</a></code></pre></div>
<p>The parameter <code>rho</code> controls the degree of correlation among the variables. The parameter <code>coef</code> sets the coefficients of the “true” variables, and in this case, the first 5 variables will have coefficient 1 while the other 495 variables will have coefficient 0. <code>snr</code> represents the designated signal-to-noise ratio (SNR) in the simulated data. Parameter <code>p.train</code> decides the proportion of the training set (relative to the total number of observations <code>n</code>).</p>
<p>To generate simulation data for the other types of generalized linear models supported by <code>msaenet</code>, simply use <code><a href="../reference/msaenet.sim.binomial.html">msaenet.sim.binomial()</a></code> (logistic regression), <code><a href="../reference/msaenet.sim.cox.html">msaenet.sim.cox()</a></code> (Cox regression), or <code><a href="../reference/msaenet.sim.poisson.html">msaenet.sim.poisson()</a></code> (Poisson regression).</p>
<p>The returned object <code>dat</code> contains both the training and test set. We will only use the training set to do the modeling (parameter tuning and model fitting), and then evaluate the model’s performance on the test set independently.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">msaenet.fit =<span class="st"> </span><span class="kw"><a href="../reference/msaenet.html">msaenet</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  dat<span class="op">$</span>x.tr, dat<span class="op">$</span>y.tr,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">alphas =</span> <span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">nsteps =</span> 10L, <span class="dt">tune.nsteps =</span> <span class="st">"ebic"</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">seed   =</span> <span class="dv">1005</span>)</a></code></pre></div>
<p>The parameter <code>alphas</code> sets the alpha tuning grid for elastic-net in all adaptive estimation steps. <code>nsteps</code> indicates how many adaptive estimation steps should be used.</p>
<p>By default, the internal parameter tuning is done by k-fold cross-validation, and the parameters which produce the minimum prediction errors will be selected. You could also set <code>parallel = TRUE</code> and run</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(doParallel)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/doParallel/topics/registerDoParallel">registerDoParallel</a></span>(<span class="kw">detectCores</span>())</a></code></pre></div>
<p>before calling this function to make the parameter tuning run in parallel. This will probably save some time if the <code>alphas</code> grid is denser and the data size is larger.</p>
<p>To select the optimal model in each estimation step with a different criterion, use the argument <code>tune</code>. Options include <code>"cv"</code> (k-fold cross-validation, default), <code>"aic"</code> (AIC), <code>"bic"</code> (BIC), and <code>"ebic"</code> (Extened BIC). Similarly, use <code>tune.nsteps</code> to specify the criterion for selecting the optimal estimation step (the optimal model from all steps), options include <code>"max"</code> (select the final-step, default), <code>"aic"</code>, <code>"bic"</code>, and <code>"ebic"</code>.</p>
<p>Let’s inspect the fitted model, by looking into the best step and the selected variables (variables with non-zero coefficients), and the number of false positive selections/true positive selections:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">msaenet.fit<span class="op">$</span>best.step</a></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/msaenet.nzv.html">msaenet.nzv</a></span>(msaenet.fit)</a></code></pre></div>
<pre><code>## [1]   2   3   4   5 114 379 464</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/msaenet.nzv.all.html">msaenet.nzv.all</a></span>(msaenet.fit)</a></code></pre></div>
<pre><code>## [[1]]
##  [1]   1   2   3   4   5   6  33  35  49  54 114 171 178 226 263 312 363
## [18] 367 379 388 441 463 464 500
## 
## [[2]]
##  [1]   1   2   3   4   5  35 114 312 379 464 500
## 
## [[3]]
## [1]   1   2   3   4   5 114 312 379 464
## 
## [[4]]
## [1]   1   2   3   4   5 114 379 464
## 
## [[5]]
## [1]   1   2   3   4   5 114 379 464
## 
## [[6]]
## [1]   2   3   4   5 114 379 464
## 
## [[7]]
## [1]   2   3   4   5 114 379 464
## 
## [[8]]
## [1]   2   3   4   5 114 379 464
## 
## [[9]]
## [1]   2   3   4   5 114 379 464
## 
## [[10]]
## [1]   2   3   4   5 114 379 464
## 
## [[11]]
## [1]   2   3   4   5 114 379 464</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/msaenet.fp.html">msaenet.fp</a></span>(msaenet.fit, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/msaenet.tp.html">msaenet.tp</a></span>(msaenet.fit, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Next, we make predictions on the test set using the fitted model, and compute some evaluation metrics, such as RMSE and MAE:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">msaenet.pred =<span class="st"> </span><span class="kw">predict</span>(msaenet.fit, dat<span class="op">$</span>x.te)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="../reference/msaenet.rmse.html">msaenet.rmse</a></span>(dat<span class="op">$</span>y.te, msaenet.pred)</a></code></pre></div>
<pre><code>## [1] 2.284905</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/msaenet.mae.html">msaenet.mae</a></span>(dat<span class="op">$</span>y.te, msaenet.pred)</a></code></pre></div>
<pre><code>## [1] 1.752406</code></pre>
<p>A coefficient plot that shows the coefficient changes of all the variables across every adaptive estimation step:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">plot</span>(msaenet.fit, <span class="dt">label =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="msaenet_files/figure-html/unnamed-chunk-7-1.png" width="750" height="600"></p>
<p>The y-axis in the plot represents the relative effect size estimations (standardized into [0, 1]) of the variables.</p>
<p>Plot the change of the information criterion (EBIC here) used to select the optimal step:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">plot</span>(msaenet.fit, <span class="dt">type =</span> <span class="st">"criterion"</span>)</a></code></pre></div>
<p><img src="msaenet_files/figure-html/unnamed-chunk-8-1.png" width="750" height="450"></p>
<p>Create a Cleveland dot plot for the model coefficients at the optimal step:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">plot</span>(msaenet.fit, <span class="dt">type =</span> <span class="st">"dotplot"</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">label.cex =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="msaenet_files/figure-html/unnamed-chunk-9-1.png" width="750" height="600"></p>
<p>To plot the absolute values of the coefficients instead of the raw coefficients, use <code>abs = TRUE</code>.</p>
<p>The vanilla adaptive elastic-net <span class="citation">(Zou and Zhang 2009)</span> is implemented by the function <code><a href="../reference/aenet.html">aenet()</a></code>. For multi-step adaptive estimation based on MCP-net or SCAD-net, see <code><a href="../reference/amnet.html">?amnet</a></code>, <code><a href="../reference/asnet.html">?asnet</a></code>, <code><a href="../reference/msamnet.html">?msamnet</a></code>, and <code><a href="../reference/msasnet.html">?msasnet</a></code> for details. All the analyses above apply to the models fitted by these functions as well.</p>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>If you used <code>msaenet</code> in your research, please feel free to cite our paper <span class="citation">(Xiao and Xu 2015)</span> in your publications. If you have any questions or have a bug to report, please <a href="mailto:me@nanx.me">email me</a> or <a href="https://github.com/road2stat/msaenet/issues">create an issue</a> on GitHub.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-xiao2015msaenet">
<p>Xiao, Nan, and Qing-Song Xu. 2015. “Multi-Step Adaptive Elastic-Net: Reducing False Positives in High-Dimensional Variable Selection.” <em>Journal of Statistical Computation and Simulation</em> 85 (18):3755–65.</p>
</div>
<div id="ref-zou2009aenet">
<p>Zou, Hui, and Hao Helen Zhang. 2009. “On the Adaptive Elastic-Net with a Diverging Number of Parameters.” <em>The Annals of Statistics</em> 37 (4):1733–51.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#walkthrough">Walkthrough</a></li>
      <li><a href="#summary">Summary</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan Xiao, Qing-Song Xu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
